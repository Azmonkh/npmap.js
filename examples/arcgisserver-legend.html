<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <script src="../node_modules/reqwest/reqwest.min.js"></script>
    <title>ArcGIS Layer | Examples | NPMap.js</title>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        bottom: 0;
        position: absolute;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      reqwest({
        success: function(response) {
          var html = '';

          console.log(response.layers);

          for (var i = 0; i < response.layers.length; i++) {
            html += '<div class="legend-title">' + response.layers[0].layerName + '</div>' + '<ul class="legend-labels">' +
            '<li>' + response.layers[0].legend[i].label + '&nbsp;<img src="' + response.layers[0].legend[i].imageData + '"></li>';
          }

          window.NPMap = {
            div: 'map',
            baseLayers: [{
              attribution: 'Esri',
              clickable: false,
              tiled: true,
              type: 'arcgisserver',
              url: 'http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'
            }],
            legendControl: {
              position: 'bottomright',
              html: html
            },
            maxZoom: 13,
            overlays: [{
              attribution: 'Esri',
              layers: '0',
              name: 'Beach Access Lines',
              opacity: 0.5,
              popup: {
                description: {
                  fields: [
                    ''
                  ],
                  format: 'table'
                }
              },
              tiled: false,
              type: 'arcgisserver',
              url: 'http://mapservices.nps.gov/arcgis/rest/services/CAHA_Access_Line/MapServer'
            }]
          };

          (function() {
            var s = document.createElement('script');
            s.src = '../dist/npmap-bootstrap.js';
            document.body.appendChild(s);
          })();
        },
        type: 'jsonp',
        url: 'http://mapservices.nps.gov/arcgis/rest/services/CAHA_Access_Line/MapServer/legend?f=pjson'
      });
    </script>
  </body>
</html>
