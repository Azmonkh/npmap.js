<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <script src="../node_modules/reqwest/reqwest.min.js"></script>
    <title>ArcGIS Layer | Examples | NPMap.js</title>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        bottom: 0;
        position: absolute;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      reqwest({
        success: function(response) {
          var html = '',
          name = "Beach Access";

          for (var i = 0; i < response.layers.length; i++) {
            html += '<h2 class="legend-title"><em>' + response.layers[0].layerName + '</em></h2>' + '<ul class="legend-labels">'
          }
          for (var i = 0; i < response.layers[0].legend.length; i++) {
            html += '<li><img src="data:' + response.layers[0].legend[i].imageData + ';base64,' + response.layers[0].legend[i].imageData + '">&nbsp;' + response.layers[0].legend[i].label + '</li>';
          }

          window.NPMap = {
            div: 'map',
            baseLayers: [{
              attribution: 'Esri',
              clickable: false,
              tiled: true,
              type: 'arcgisserver',
              url: 'http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer'
            }],
            center: {
              lat: 35.59973293205194,
              lng: -75.37099182550776
            },
            legendControl: {
              position: 'bottomright',
              html: '<h1 class="layer name">' + name + '</h1>' + html + '</ul>'
            },
            overlays: [{
              attribution: 'Esri',
              layers: '0',
              name: name,
              opacity: 0.5,
              popup: {
                description: {
                  fields: [
                    'Label',
                    'Open_',
                  ],
                  format: 'table'
                }
              },
              tiled: false,
              type: 'arcgisserver',
              url: 'http://mapservices.nps.gov/arcgis/rest/services/CAHA_Access_Line/MapServer'
            }],
            zoom: 9
          };

          (function() {
            var s = document.createElement('script');
            s.src = '../dist/npmap-bootstrap.js';
            document.body.appendChild(s);
          })();
        },
        type: 'jsonp',
        url: 'http://mapservices.nps.gov/arcgis/rest/services/CAHA_Access_Line/MapServer/legend?f=pjson'
      });
    </script>
  </body>
</html>
