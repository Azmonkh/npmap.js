<!--

For styles set in data source, support simplestyle spec, with the "marker-library" (maki is default, and maki/npmaki are currently supported) extension.
For styles set in NPMap.js config, support Leaflet styles, set in the "styles" property:

    styles: {
      color: '#03f',
      fill: true,
      fillColor: '#03f',
      fillOpacity: 0.2,
      marker: {
        color: '#000000',
        size: 'small',
        type: 'maki', // If 'icon', the marker object is treated like a Leaflet Icon. If 'circle', it is treated like a Leaflet CircleMarker. If 'maki' or 'npmaki', 
        symbol: 'park'
      },
      opacity: 0.5,
      stroke: false,
      width: 5
    }

Any one of the configs above can either be a string/boolean/number of a function. If a config is a function, the function is called, with the properties for the feature that is getting symbolized passed in. It should return a valid value for the config. The "styles" config can also be a function. If it is, it should return the entire, or some subset, of the "styles" object.

// Run all style strings through Handlebars.
// TODO: What about preset colors?

NPMap = {
  baseLayers: [
    'mapbox-light',
  {
    attribution: '',
    name: 'Aerial',
    tiled: true,
    type: 'arcgisserver',
    url: ''
  }],
  controls: {
    geocoder: true,
    home: true,
    smallzoom: true
  },
  overlays: [{
    clickable: true,
    clustered: false,
    styles: {
      color: '#03f',
      fill: true,
      fillColor: '#03f',
      fillOpacity: 0.2,
      marker: {
        color: '#000000',
        size: 'small',
        type: 'maki',
        symbol: 'park'
      },
      opacity: 0.5,
      stroke: false,
      width: 5
    }
    type: 'geojson',
    url: ''
  },{
    clickable: true,
    clustered: true,
    styles: {
      color: 'gold',
      fill: false
    },
    type: 'kml',
    url: ''
  }]
};

OR?????

Last thought before bed: I think the following is the way to go. You can easily differentiate between geometry types in the GeoJSON mixin (which accounts for all vector layers), and this should also work for CartoDB, as CartoDB supports multiple geometry types per "layer", as well. The split styles should be able to be easily converted into CartoCSS.

You can still support "consolidated" styles (all the styles being specified together in a single styles object) too.

overlays: [{
  styles: {
    line: {
      leaflet: true
    },
    point: {
      fill: '#e9a',
      radius: 10,
      type: 'circle' (defaults to 'marker')
    },
    polygon: {
      leaflet: true
    }
  }
}]
















-->


<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>Styling Vectors | Examples | NPMap.js</title>
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      #map {
        bottom: 0;
        position: absolute;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var NPMap = {
        center: {
          lat: 42.42,
          lng: -104.71
        },
        div: 'map',
        overlays: [{
          name: 'National Parks',
          popup: '<div class="title"><a href="http://www.nps.gov/{{toLowerCase Code}}">{{Name}}</a></div>',
          styles: function(data) {
            return {
              point: {
                'marker-size': 'small',
                'marker-symbol': data.Code.slice(0, 1).toLowerCase()
              }
            };
          },
          type: 'geojson',
          url: 'data/national_parks.geojson'
        },{
          cluster: true,
          styles: {
            point: {
              'marker-color': '#5e9fd5',
              'marker-size': 'small'
            }
          },
          type: 'csv',
          url: 'data/colorado_cities_simplestyle.csv'
        },{
          type: 'geojson',
          url: 'data/simplestyle.geojson'
        },{
          styles: {
            line: {
              'stroke': '#03f',
              'stroke-opacity': 0.8,
              'stroke-width': 5
            },
            point: {
              'marker-color': '#fd9126',
              'marker-size': 'small'
            },
            polygon: {
              'fill': '#03f',
              'fill-opacity': 0.2,
              'stroke': '#000',
              'stroke-opacity': 0.8,
              'stroke-width': 8
            }
          },
          type: 'geojson',
          url: 'data/utah_vectors.geojson'
        }],
        zoom: 6
      };

      (function() {
        var s = document.createElement('script');
        s.src = '../dist/npmap-bootstrap.js';
        document.body.appendChild(s);
      })();
    </script>
  </body>
</html>
